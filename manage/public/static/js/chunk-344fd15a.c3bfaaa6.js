(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-344fd15a"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},d2a7:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data}},[a("el-table-column",{attrs:{prop:"studentID",label:"学号",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"age",label:"年龄",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"study",label:"学制",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"major",label:"专业",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"classes",label:"班级",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"citycenter",label:"市场部",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"chengji",label:"当前成绩",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"graduation",label:"还差成绩",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"failss",label:"挂科次数",sortable:""}})],1),e._v(" "),a("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v("\n    Export Excel\n  ")]),e._v(" "),a("div",{staticClass:"index"},[a("el-upload",{ref:"upload",attrs:{action:"/","show-file-list":!1,"on-change":e.importExcel,"auto-upload":!1}},[a("el-button",{attrs:{icon:"el-icon-upload",size:"small",type:"primary"}},[e._v("\n        导入\n      ")])],1)],1)],1)},s=[],l=(a("ac6a"),a("7f7f"),a("28a5"),a("96cf"),a("3b8d")),r=a("bc3a"),o=a.n(r),i=function(e,t){return o.a.post("http://132.232.89.22:8080/allstudentPage",{page:e,pageSize:t})},c=function(e){return console.log(e),o.a.post("http://132.232.89.22:8080/inExcel",{excarr:e})},u=a("ed08"),p=a("1146"),h=a.n(p),d={data:function(){return{data:[],page:1,pageSize:1,autoWidth:!0,bookType:"xlsx"}},created:function(){this.getallstudents()},methods:{getallstudents:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i(this.page,this.pageSize);case 2:t=e.sent,a=t.data,this.data=a.data;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),importExcel:function(e){var t=this,a=e.name.split(".")[1],n=["xlsx","xlc","xlm","xls","xlt","xlw","csv"].some((function(e){return e===a}));n?this.file2Xce(e).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var n,s,l,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(a&&a.length>0)){e.next=8;break}for(t.xlsxJson=a,n=[],s=0;s<=t.xlsxJson.length;s++)l={studentID:t.xlsxJson[0].sheet[s]["学号"],name:t.xlsxJson[0].sheet[s]["姓名"],sex:t.xlsxJson[0].sheet[s]["性别"],age:t.xlsxJson[0].sheet[s]["年龄"],study:t.xlsxJson[0].sheet[s]["学制"],major:t.xlsxJson[0].sheet[s]["专业"],classes:t.xlsxJson[0].sheet[s]["班级"],citycenter:t.xlsxJson[0].sheet[s]["市场部"],chengji:t.xlsxJson[0].sheet[s]["当前成绩"],graduation:t.xlsxJson[0].sheet[s]["还差成绩"],failss:t.xlsxJson[0].sheet[s]["挂科次数"]},n.push(l);return e.next=6,c(n);case 6:r=e.sent,t.data=r.data.data;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):this.$message("格式错误！请重新选择")},file2Xce:function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){var a=this,n=e.target.result;this.wb=h.a.read(n,{type:"binary"});var s=[];this.wb.SheetNames.forEach((function(e){s.push({sheetName:e,sheet:h.a.utils.sheet_to_json(a.wb.Sheets[e])})})),t(s)},n.readAsBinaryString(e.raw)}))},handleDownload:function(){var e=this;Promise.all([a.e("chunk-53379ef8"),a.e("chunk-748b566e")]).then(a.bind(null,"4bf8d")).then((function(t){var a=["学号","姓名","性别","年龄","学制","专业","班级","市场部","当前成绩","还差成绩","挂科次数"],n=["studentID","name","sex","age","study","major","classes","citycenter","chengji","graduation","failss"],s=e.formatJson(n,e.data);t.export_json_to_excel({header:a,data:s,autoWidth:e.autoWidth,bookType:e.bookType})}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?Object(u["f"])(t[e]):t[e]}))}))}}},b=d,x=a("2877"),f=Object(x["a"])(b,n,s,!1,null,null,null);t["default"]=f.exports}}]);